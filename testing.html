<?php
	require_once("../mysql_connect.php");
?>

<!DOCTYPE html>
<html>
	<head>
		<title>Associate </title>
			<meta charset="utf-8">
			<meta name="viewport" content="width=device-width, initial-scale=1">
			<link rel="icon" type="image/png" href="resource/dlsulogo.png" />
			<script src="layout/jquery.min.js"></script>
			<link rel="stylesheet" href="layout/bootstrap.min.css">
			<link rel="stylesheet" href="layout/pageformat.css">
			<script src="layout/bootstrap.min.js"></script>
			
			<style>
			/* Remove the navbar's default margin-bottom and rounded borders */ 
			.navbar {
			  margin-bottom: 0;
			  border-radius: 0;
			}

			/* Set height of the grid so .sidenav can be 100% (adjust as needed) */
			.row.content {height: 450px}

			/* Set gray background color and 100% height */
			.sidenav {
			  padding-top: 20px;
			  background-color: #f1f1f1;
			  height: 100%;
			}

			/* Set black background color, white text and some padding */
			footer {
			  background-color: #555;
			  color: white;
			  padding: 15px;
			}

			/* On small screens, set height to 'auto' for sidenav and grid */
			@media screen and (max-width: 767px) {
			  .sidenav {
				height: auto;
				padding: 15px;
			  }
			  .row.content {height:auto;} 
			}
			
			.{
				font-size: 16px;
				color:#332929;
			}
			
			</style>
	</head>
	<body background="resource/green.jpg" style="background-attachment:fixed; background-repeat:no-repeat;">
		<div>	<!-- Navbar -->
			<nav class="navbar navbar-inverse">
					<div class="container-fluid">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>                        
						</button>
						<a class="img-fluid" href="home.html"><img style="padding-top:6px" src="resource/logo.png"></a>
					</div>
					<div class="collapse navbar-collapse" id="myNavbar">
						<ul class="nav navbar-nav">
							<li class="active"><a href="#">Home</a></li>
							<li><a href="#">About</a></li>
							<li><a href="#">Projects</a></li>
							<li><a href="#">Contact</a></li>
						</ul>
						<ul class="nav navbar-nav navbar-right">
							<li><a href="login.php"><span></span>Login</a></li>
							<li><a href="signup.php"><span></span>Register</a></li>
						</ul>
					</div>
				  </div>
				</nav>
		</div>	<!--Navbar -->

		<div style="padding-top:10px"> <!-- Tables and stuff-->
			<div align="center" margin="auto" style=" background-color:#73CD6F; padding-top:10px; padding-bottom:10px; padding-left:5px; padding-right:5px; border-radius:25px; border: solid white">
				<!-- Main content -->
				<div class="tabbable-panel">
					<div>
						<section class="content">
						  <div class="row">
							<div class="col-xs-12">
							  
								<div class="tabbable-line" style="padding-right:1px">
									<ul class="nav nav-tabs">
									
									  <li class="active">
										<a href="#assocprodtosupp" data-toggle="tab">
											Associate Prod to Supp
										</a>
									  </li>
									  
									  <li>
									    <a href="#assoctbl" data-toggle="tab">
											Association Table
										</a>
									  </li>
									  <div style="width:150px; display:inline;" align="right">
										<form action="#" method="get" class="sidebar-form">
											<div class="input-group">
											<input type="text" name="q" class="form-control" placeholder="Search..." style="border-radius:5px">
											</div>
										</form>
									</div>
									</ul>
									
									
								</div>
								<div class="tab-content">
								  <div class="tab-pane active" id="assocprodtosupp">
									  <section class="content">
										  <div class="row">
											<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
											<div class="col-sm-6">
											  <div class="box box-primary">
												<div class="box-header">
												  <h3 class="box-title">Medicine List</h3>
												</div>
												<!-- /.box-header -->
												<div class="box-body">
												  <table id="myTable" class="table table-bordered table-striped">
													<thead>
														<tr>
														  <th></th>
														  <th>Brand name <img src="resource/glyphiconsort.png" onclick="sortTable(1)"> </th>
														  <th>Generic name <img src="resource/glyphiconsort.png" onclick="sortTable(2)"> </th>
														  <th>Dosage <img src="resource/glyphiconsort.png" onclick="sortTable(3)"> </th>
														  <th>Medicine type <img src="resource/glyphiconsort.png" onclick="sortTable(4)"> </th>
														</tr>
													</thead>
													<tbody>
														<tr>
															<td><input name="case[]" value="1" type='checkbox' class='case' style='width: 2rem; height: 2rem;'></div></td>
															<td>Z brand</td>
															<td>1</td>
															<td>1</td>
															<td>1</td>
														</tr>
														
														<tr>
															<td><input name="case[]" value="2" type='checkbox' class='case' style='width: 2rem; height: 2rem;'></div></td>
															<td>B brand</td>
															<td>2</td>
															<td>2</td>
															<td>2</td>
														</tr>
														
														<tr>
															<td><input name="case[]" value="3" type='checkbox' class='case' style='width: 2rem; height: 2rem;'></div></td>
															<td>C Brand</td>
															<td>3</td>
															<td>3</td>
															<td>3</td>
														</tr>
														
														<tr>
															<td><input name="case[]" value="4" type='checkbox' class='case' style='width: 2rem; height: 2rem;'></div></td>
															<td>D brand</td>
															<td>4</td>
															<td>4</td>
															<td>4</td>
														</tr>
														
														<!--
														<?php
															$query = "SELECT M.MEDICINEID, M.BRANDNAME, M.GENERICNAME, M.DOSAGE, MT.DESCRIPTION
																	  FROM MEDICINE M JOIN REF_MEDICINETYPE MT
																						ON M.MEDICINETYPE = MT.MEDICINETYPE;";
																						
															$result = mysqli_query($dbc, $query);
															
															while ($row = mysqli_fetch_array($result, MYSQLI_ASSOC))
															{
																echo "<tr>
																		<td><div style='text-align: center;'><input type='checkbox' class='checkbox' name='medicines[]' value='{$row['MEDICINEID']}' style='width: 2rem; height: 2rem;'></div></td>
																		<td>{$row['BRANDNAME']}</td>
																		<td>{$row['GENERICNAME']}</td>
																		<td>{$row['DOSAGE']}</td>
																		<td>{$row['DESCRIPTION']}</td>
																	  </tr>";
															}
														?>
														-->
													</tbody>
													<tfoot>
													<tr>
													  <th></th>
													  <th>Brand name</th>
													  <th>Generic name</th>
													  <th>Dosage</th>
													  <th>Medicine type</th>
													</tr>
													</tfoot>
												  </table>
												</div>
												<!-- /.box-body -->
											  </div>
											  <!-- /.box -->
											</div>
											<!-- /.col -->
											<div class="col-sm-6">
											  <div class="box box-primary">
												<div class="box-header">
												  <h3 class="box-title">Supplier List</h3>
												</div>
												<!-- /.box-header -->
												<div class="box-body">
												  <table id="example3" class="table table-bordered table-striped">
													<thead>
													<tr>
													  <th></th>
													  <th>Supplier name</th>
													  <th>Address</th>
													</tr>
													</thead>
													<tbody>
													<?php
															$query = "SELECT SUPPLIERID, SUPPLIERNAME, ADDRESS
																	  FROM SUPPLIER;";
																						
															$result = mysqli_query($dbc, $query);
															
															while ($row = mysqli_fetch_array($result, MYSQLI_ASSOC))
															{
																echo "<tr>
																		<td><div style='text-align: center;'><input type='checkbox' class='checkbox' name='suppliers[]' value='{$row['SUPPLIERID']}' style='width: 2rem; height: 2rem;'></div></td>
																		<td>{$row['SUPPLIERNAME']}</td>
																		<td>{$row['ADDRESS']}</td>
																	  </tr>";
															}
														?>
													</tbody>
													<tfoot>
													<tr>
													  <th></th>
													  <th>Supplier name</th>
													  <th>Address</th>
													</tr>
													</tfoot>
												  </table>
												</div>
												<!-- /.box-body -->
											  </div>
											  <!-- /.box -->
											</div>
											<!-- /.col -->
											</form>
										  </div>
										  <!-- /.row -->
										</section>
										<!-- /.content -->
											<div align="right" style="padding-right:10px">
												<nav aria-label="Page navigation example">
													<ul class="pagination pagination-sm">
													  <li class="page-item"><a class="page-link" href="#">Previous</a></li>
													  <li class="page-item"><a class="page-link" href="#">1</a></li>
													  <li class="page-item"><a class="page-link" href="#">2</a></li>
													  <li class="page-item"><a class="page-link" href="#">3</a></li>
													  <li class="page-item"><a class="page-link" href="#">Next</a></li>
													</ul>
												</nav>
											 
											</div>
										 <button type="submit" name ="submit" class="btn btn-outline-secondary">Submit</button>
								  </div>
								
								  <div class="tab-pane" id="assoctbl">
									  <section class="content">
										  <div class="row">
											<div class="col-sm-12">
											  <div class="box box-primary">
												<div class="box-header">
												  <h3 class="box-title">Association Table</h3>
												</div>
												<!-- /.box-header -->
												<div class="box-body">
												  <table id="example1" class="table table-bordered table-striped">
													<thead>
													<tr>
													  <th>Brand name</th>
													  <th>Generic name</th>
													  <th>Dosage</th>
													  <th>Medicine type</th>
													  <th>Supplier</th>
													</tr>
													</thead>
													
													<tbody>
													  <?php
														$query = "SELECT M.BRANDNAME, M.GENERICNAME, M.DOSAGE, MT.DESCRIPTION, S.SUPPLIERNAME
																  FROM MEDICINE M JOIN REF_MEDICINETYPE MT
																					ON M.MEDICINETYPE = MT.MEDICINETYPE
																				  JOIN MEDICAL_SUPPLIERS MS
																					ON M.MEDICINEID = MS.MEDICINEID
																				  JOIN SUPPLIER S
																					ON MS.SUPPLIERID = S.SUPPLIERID;";
																						 
														$result = mysqli_query($dbc, $query);
														
														while ($row = mysqli_fetch_array($result, MYSQLI_ASSOC))
														{
															echo "<tr>
																	<td>{$row['BRANDNAME']}</td>
																	<td>{$row['GENERICNAME']}</td>
																	<td>{$row['DOSAGE']}</td>
																	<td>{$row['DESCRIPTION']}</td>
																	<td>{$row['SUPPLIERNAME']}</td>
																  </tr>";
														}
													  ?>
													</tbody>
													<tfoot>
													<tr>
													  <th>Brand name</th>
													  <th>Generic name</th>
													  <th>Dosage</th>
													  <th>Medicine type</th>
													  <th>Supplier</th>
													</tr>
													</tfoot>
												  </table>
												</div>
												<!-- /.box-body -->
											  </div>
											  <!-- /.box -->
											</div>
											<!-- /.col -->
										  </div>
										  <!-- /.row -->
										</section>
										<!-- /.content -->
								  </div>
								  
								</div>
								<!-- /.tab-content -->
							  </div>
							  <!-- /.nav-tabs-custom -->
							</div>
							<!-- /.col -->
						  </div>
						  <!-- /.row -->
						</section>
						<!-- /.content -->
					</div>
				</div>
			</div>
		</div>
		  <!-- Tables and stuff -->

  

<!-- jQuery 3 -->
<script src="../../bower_components/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="../../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- DataTables -->
<script src="../../bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../../bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<!-- SlimScroll -->
<script src="../../bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="../../bower_components/fastclick/lib/fastclick.js"></script>
<!-- iCheck 1.0.1 -->
<script src="../../plugins/iCheck/icheck.min.js"></script>
<!-- AdminLTE App -->
<script src="../../dist/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="../../dist/js/demo.js"></script>
<!-- page script -->
<script>
  $(function () {
    $('#example1').DataTable()
    $('#example2').DataTable({
      'paging'      : true,
      'lengthChange': true, //
      'searching'   : true, //
      'ordering'    : true,
      'info'        : true,
      'autoWidth'   : true  //
    })
	$('#example3').DataTable()
	
	//iCheck for checkbox
    $('input[type="checkbox"].minimal').iCheck({
      checkboxClass: 'icheckbox_minimal-blue'
    })
  })
  
  
function sortTable(n) {
  var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
  table = document.getElementById("myTable");
  switching = true;
  //Set the sorting direction to ascending:
  dir = "asc"; 
  /*Make a loop that will continue until
  no switching has been done:*/
  while (switching) {
    //start by saying: no switching is done:
    switching = false;
    rows = table.getElementsByTagName("TR");
    /*Loop through all table rows (except the
    first, which contains table headers):*/
    for (i = 1; i < (rows.length - 1); i++) {
      //start by saying there should be no switching:
      shouldSwitch = false;
      /*Get the two elements you want to compare,
      one from current row and one from the next:*/
      x = rows[i].getElementsByTagName("TD")[n];
      y = rows[i + 1].getElementsByTagName("TD")[n];
      /*check if the two rows should switch place,
      based on the direction, asc or desc:*/
      if (dir == "asc") {
        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          //if so, mark as a switch and break the loop:
          shouldSwitch= true;
          break;
        }
      } else if (dir == "desc") {
        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
          //if so, mark as a switch and break the loop:
          shouldSwitch = true;
          break;
        }
      }
    }
    if (shouldSwitch) {
      /*If a switch has been marked, make the switch
      and mark that a switch has been done:*/
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
      //Each time a switch is done, increase this count by 1:
      switchcount ++;      
    } else {
      /*If no switching has been done AND the direction is "asc",
      set the direction to "desc" and run the while loop again.*/
      if (switchcount == 0 && dir == "asc") {
        dir = "desc";
        switching = true;
      }
    }
  }
}

function myfunc(ele) {

 var values = new Array();
       $.each($("input[name='case[]']:checked").closest("td").siblings("td"),
              function () {
                   values.push($(this).text());
              });
    
       alert("val---" + values.join (", "));
 }
     

$(document).ready(function() {
    $("input.case").click(myfunc);
});

</script>
</body>
</html>
